---
title: "Introductory chapter questions"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
knitr::opts_chunk$set(echo = FALSE)
```


## Comparison of plot sampling and distance sampling

#### Just testing

Watch this video and answer the following questions

![](https://www.youtube.com/embed/8KWHu2Hj7Ys?rel=0){width=80%}

### Your understanding of plot sampling 

Distance sampling is an extension of plot sampling, so there are some similarities between the two.  These questions ask you to compare between the two methods.

```{r plotsamp}
quiz(caption="Questions about plot sampling",
  question("What would be the appropriate key function to model data collected using plot sampling?",
    answer("uniform", correct = TRUE),
    answer("half normal", 
           message="Probability of detection is constant and perfect at all distances."),
    answer("hazard rate", 
           message="Probability of detection is constant and perfect at all distances."),
    answer("negative exponential", 
           message="Probability of detection is constant and perfect at all distances.")
  ),
  question("Why should there be uncertainty in density estimates generated by plot sampling when there is no detection function to fit?",
    answer("Because only a portion of the study area is sampled; inference must be drawn to portions of the study area not visited.", correct = TRUE),
    answer("You cannot be certain everything was detected.", 
           message="While this is possible, the magnitude of that uncertainty cannot be quantified."),
    answer("Nature is stochastic, so uncertainty exists in every aspect of population assessment.",
           message="A true statement, but not relevant to this question."),
    answer("There is no uncertainty in estimates derived from plot sampling.",
           message="Incorrect; by the nature of sampling, inference needs to be made about something that is not observed.")
  )
)
```

## Estimating probability of detection

### Estimating $\hat{P}_a$

```{r p-sub-a}
quiz(caption="Estimating probability of detecting animals within truncation distance of transects",
  question("If a detection function has a small shoulder (or no shoulder at all), what can we say?",
    answer("$\\hat{P}_a$ will be small", correct = TRUE),
    answer("A hazard rate detection function is likely to be suitable",
           message="Hazard rate **has** a shoulder, so is unlikely to be suitable."),
    answer("Precision in the estimate of $\\hat{P}_a$ will be poorer than if there is a distinct shoulder", correct = TRUE,
           message="With the detection function roughly horizontal at small distances, parameter(s) of the detection function can be estimated with greater precision."),
    answer("The area under the fitted detection function curve will be roughly equal to the area under the rectangle",
           message="A [sharply declining detection function](https://workshops.distancesampling.org/online-course/syllabus/Chapter7/#multi-species-survey---montrave-line-transects) will have a small area relative to the area under the rectangle.")
  ),
  question("Why should there be uncertainty in density estimates generated by plot sampling when there is no detection function to fit?",
    answer("Because only a portion of the study area is sampled; inference must be drawn to portions of the study area not visited.", correct = TRUE),
    answer("There is uncertainty about the true detection function", 
           message="By assumption, all animals are detected, so there is no detection function."),
    answer("The survey provides no information about the segment of the animal population away from the surveyed transects", 
           message="This is partially true.  By assumption distance sampling assumes that transects are placed randomly so that data collected on transects is relevant to portions of the study area not sampled."),
    answer("Variability in encounter rates between transects makes us uncertain about the encounter rate on a transect located elsewhere on the study area",
           correct=TRUE)
  )
)
```

### Key functions

You can include any number of single or multiple choice questions as a quiz. Use the `question` function to define a question and the `quiz` function for grouping multiple questions together.  

<img src="images/hrhist(minke).png" style="float:right; width:277px; height:370px">

```{r animage}
#quiz(caption="Examine the data and detection function at right for these questions.",
  question("What is the key function fitted to these perpendicular distance data?",
    answer("hazard rate", correct=TRUE),
    answer("half normal", 
           message="Note the existence of a shoulder on the function; half normal has a gradual decline even at small perpendicular distances."),
    answer("uniform",
           message="Seriously?  A uniform key function does not diminish at all."),
    answer("negative exponential",
           message="Negative exponential has **no** shoulder and drops away rapidly at small perpendicular distances.")
  ) #,
  question("Can you determine if there were adjustments included in detection function; if so how many?",
    answer("0", correct=TRUE),
    answer("1", message="There are no 'wiggles' in the detection function"),
    answer("2", message="There are no 'wiggles' in the detection function as would be caused by two adjustment terms"),
    answer("cannot determine",
           message="if you cannot determine, then review the lecture on key functions and adjustment terms")
  )
#)
```

## Calculations of density and abundance

To confirm computations made by program Distance, below are components from a line transect distance sampling survey and analysis needed to produce a density estimate.  Use these components to answer the following questions, along with these formulas from [slide 7 of lecture in Chapter 1.](https://workshops.distancesampling.org/online-course/lecturepdfs/Ch1/L1-5%20Three%20More%20Ways.pdf)

$$
\hat{D} = \frac{n}{2wL \hat{P}_a} \hspace{2cm} \hat{N} = \frac{nA}{2wL \hat{P}_a}
$$

```{r minkenorth, message=FALSE, results='hide'}
library(Distance)
data(minke)
out <- summary(ds(minke[minke$Region.Label=="North",]))
knitr::kable(out$dht$individuals$summary[2:7])
```

|   Area| CoveredArea|  Effort|  n|  k|Encounter Rate|
|------:|-----------:|-------:|--:|--:|-------------:|
| 630582|    5270.514| 1358.38| 51| 12|     0.0375447|

The truncation distance ($w$) for the survey was `r round(out$ds$width, 2)`. From the fitting of a detection function, we also know that the probability of detection of animals within the covered area $(\hat{P}_a)$ is `r round(out$dht$individuals$average.p,4)`.


```{r calculate}
quiz(caption="Perform calculations by hand to duplicate results produced by Distance software",
  question("What is the estimated density of animals based upon this summary information?",
    answer("11282", 
           message="This is the estimate of abundance."),
    answer("0.0179", correct = TRUE),
    answer("0.1789", 
           message="Off by one order of magnitude."),
    answer("1128", 
           message="Abundance estimate off by an order of magnitude.")
  ),
  question("What is the estimated *abundance* of animals in the study area?",
    answer("11282", correct = TRUE),
    answer("0.0179", 
           message="This is the density rather than abundance estimate"),
    answer("0.1789", 
           message="Density estimate off by one order of magnitude."),
    answer("1128", 
           message="Abundance estimate off by an order of magnitude.")
  )
)
```